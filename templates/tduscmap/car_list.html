{% extends 'base.html' %}
{% block content %}

{% load static %}
<link rel="stylesheet" href="{% static 'stylesmymaps.css' %}" type="text/css">
  <title>Liste des voitures</title>

<body>
    <form method="post" action="{% url 'car_select' %}">
        <select name="car_id">
          {% for car in cars %}
            <option value="{{ car.id }}">{{ car }}</option>
          {% endfor %}
        </select>
        {% csrf_token %}
        <button type="submit">Voir l'historique des prix</button>
      </form>
      {% if car_selected %}
      <h1>Historique des Prix de {{ car_selected }}</h1>
      <canvas id="priceChart" style="width: 40%;"></canvas>
  
      <script>
        
        const ctx = document.getElementById('priceChart').getContext('2d');
        const priceChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: {{ dates|safe }},
                datasets: [{
                    label: 'Prix',
                    data: {{ price_values|safe }},
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false,
                }]
            },
            options: {
                scales: {
                    x: {
                        ticks: {
                            autoSkip: true,
                            maxTicksLimit: 5,  // Limite le nombre d'étiquettes sur l'axe X
                        },
                    },
                    y: {
                        ticks: {
                            stepSize: 50000,  // Ajuste l'intervalle entre les étiquettes sur l'axe Y
                        },
                    }
                },
                aspectRatio: 2.5,
            }
        });
      </script>
    {% endif %}
</body>
{% endblock content %}